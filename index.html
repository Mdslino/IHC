<!DOCTYPE html>
<html>
  <head>
	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    
	<style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      .wrap { max-width: 75em; min-height: 40em; height:100%; width:100%; margin: 0 auto; padding-top: 2.5%;}
      #map-canvas { height: 90%; }
    </style>
	
	<!-- CARREGANDO O API DO GOOGLE MAPS -->
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?sensor=true"></script>
	
	<!-- BIBLIOTECA JQUERY -->
	<script src="http://code.jquery.com/jquery-latest.min.js"></script>
	
	<!-- CONFIGURANDO O MAPA E ALGUMAS OPCOES BASICAS -->
    <script type="text/javascript">     
	  
		$(document).ready(function(){
		
			var map;
			var markers = [];
			var centerPos = new google.maps.LatLng(-23.300261, -45.965545);
			var zoomLevel = 12;			
			var mapOptions = {center: centerPos, zoom: zoomLevel};
			
			function removeMarkers(){
    			for(i=0; i<markers.length; i++){
        			markers[i].setMap(null);
    			}
			}

			function mapAll(idade){
				if(markers.length > 0){
					removeMarkers();
				$.getJSON("https://api.myjson.com/bins/1r2p9",function(data) { //BUSCANDO OS DADOS NO MYJSON
					$.each(data.enderecos, function(i){
						if(idade <= this.idadeMax && idade >= this.idadeMin){
							var latLng = new google.maps.LatLng(this.lat, this.long);
							marker = new google.maps.Marker({ //CRIANDO OS MARCADORES NO MAPA
							position: latLng,
							title: 'Nome: ' + this.nome + '\n' + 'Endereco: ' + this.end + '\n' + 'Telefone: ' + this.telefone + '\n' + 'Email: ' + this.email + '\n' + 'Idade Minima: ' + this.idadeMin + '\n' + 'Idade Maxima: ' + this.idadeMax,
							map: map,
							animation: google.maps.Animation.DROP,
							icon: 'img/marcador.png'
						    });
						    markers.push(marker);
						    markers[i].setMap(map);

						}
					});
					alert("If")
			    });
				}
				else{
				
				$.getJSON("https://api.myjson.com/bins/1r2p9",function(data) { //BUSCANDO OS DADOS NO MYJSON
					$.each(data.enderecos, function(i){
						if(idade <= this.idadeMax && idade >= this.idadeMin){
							var latLng = new google.maps.LatLng(this.lat, this.long);
							marker = new google.maps.Marker({ //CRIANDO OS MARCADORES NO MAPA
							position: latLng,
							title: 'Nome: ' + this.nome + '\n' + 'Endereco: ' + this.end + '\n' + 'Telefone: ' + this.telefone + '\n' + 'Email: ' + this.email + '\n' + 'Idade Minima: ' + this.idadeMin + '\n' + 'Idade Maxima: ' + this.idadeMax,
							map: map,
							animation: google.maps.Animation.DROP,
							icon: 'img/marcador.png'
						    });
						    markers.push(marker);
						    markers[i].setMap(map);
						    
						}
					});
					alert("Else");
			    });
				}
			}
			map = new google.maps.Map( document.getElementById("map-canvas"), mapOptions );
			$("#botao").click(function() {
				var idade = $("#idade").val();
				mapAll(idade);
				
			});
		});
	  
    </script>
	
  </head>
  
  <body> 
  
  <div class="col-md-4">
					<input required="required" type="number" class="form-control" id="idade" placeholder="Idade">
				</div>
  
  <button id="botao" type="submit" class="btn btn-primary col-md-offset-5">Buscar Escola</button>
  
	<div class="wrap">
		<div id="map-canvas"></div>
	</div>	
  </body>
  
</html>
